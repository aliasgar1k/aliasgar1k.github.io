---
title: 9.1.5 - RDP Dashboard
date: 2025-03-26 00:00:00 +/-TTTT
categories:
  - Splunk SIEM Implementation
tags:
  - splunk-siem-implementation
image: ../preview-image.png
media_subpath: /assets/img/Splunk-SIEM-Implementation/2025-03-26-9.1.5---RDP-Dashboard/
---

![](2025-03-26-9.1.5---RDP-Dashboard-1.png)

Creating a dashboard in Splunk to visualize and analyze RDP brute force attempts involves several steps. Here's a detailed guide on how to make and build searches in Splunk to create a dashboard with various panels, including a geo map, pie chart, time chart, and tables for top failed and successful RDP authentication counts, as well as a full insight table.

## Build Charts and Tables

Before we begin building a dashboard, it’s essential to create meaningful charts and tables that provide a comprehensive insight into the current ongoing situation. These charts and tables can be easily derived from quick search queries. Below are some example queries that will help us gain a quick understanding of the situation at a glance through the dashboard.

### Geo Map

Note to create geo maps to visualize threats like RDP brute force attempts tools like Splunk rely on logs from sources like Windows or Sysmon, which record IP addresses but not their geographic locations. These logs often include private IPs (e.g., 192.168.x.x), which can’t be mapped to countries since they’re internal. For public IPs, Splunk uses its own features, such as the `iplocation` command, to convert IPs into country data. Fields like `Country` are generated by Splunk, not the original logs. 

To create a geo map: 
- You write a query that extracts public IPs
- Performs a GeoIP lookup
- And visualizes the results. 
 
Private IPs, however, remain unmapped, as they lack geographic context. This process highlights how Splunk enhances raw log data with its own capabilities to provide actionable insights. But as we have setup our environment in a closed Virtual Private Network we would not be able to make a geo map. So, IF you intend to try out this you will need to expose you Client machine's RDP service to the internet using Port Forwarding using your router and this will generate a bunch of logs as their are bots on the internet that are continuously trying to get access to such services using brute force attacks and then you can use query such as below to generate a Geo Map:

```
index=windows_logs (EventCode=4625 AND Logon_Type=3)  
| stats count as attempts by Source_Network_Address 
| where attempts > 5
| iplocation Source_Network_Address   
| geostats count by Country 
```

This query searches for logs in the "windows_logs" index with a sourcetype of "WinEventLog:Microsoft-Windows-Sysmon/Operational", filters out events where the SourceIp is null, performs a GeoIP lookup on the SourceIp, and then uses the geostats command to count the number of events by country.

### Pie Chart (Failed vs. Successful Logins):

To create a pie chart that displays the number of failed and successful logins, you can use the following query:

```
index="windows_logs" EventCode IN (4624, 4625) Logon_Type=3  
| stats count by EventCode  
| eval LoginStatus=if(EventCode=4624, "Successful", "Failed")  
| sort - count  
```

This query searches for logs in the "windows_logs" index with an EventCode of either 4624 (successful login) or 4625 (failed login), and a Logon_Type of 3 (network logon). It then uses the stats command to count the number of events by EventCode, and the eval command to create a new field called LoginStatus that is either "Successful" or "Failed". Finally, it sorts the results in descending order by count.

### Time Chart 

To create a time chart that displays the number of failed logins over time, you can use the following query:

```
index=windows_logs EventCode=4625 Logon_Type=3  
| timechart span=1h count  
```

This query searches for logs in the "windows_logs" index with an EventCode of 4625 (failed login) and a Logon_Type of 3 (network logon), and then uses the timechart command to count the number of events by hour.

### Top 10 Failed RDP Authentication Counts Table

To create a table that displays the top 10 failed RDP authentication counts, you can use the following query:

```
index=windows_logs EventCode=4625 Logon_Type=3  
| rex field=_raw "Account For Which Logon Failed:[\s\S]*?Account Name:\s+(?<Targeted_Account>[^\r\n]+)"  
| stats count as Attempts by Source_Network_Address, Targeted_Account  
| sort - Attempts  
| head 10  
```

This query searches for logs in the "windows_logs" index with an EventCode of 4625 (failed login) and a Logon_Type of 3 (network logon), extracts the targeted account name using a regular expression, and then uses the stats command to count the number of attempts by source network address and targeted account. It then sorts the results in descending order by attempts and returns the top 10 results.

### Top 10 Successful RDP Authentication Counts Table

To create a table that displays the top 10 successful RDP authentication counts, you can use the following query:

```
index=windows_logs EventCode=4624 Logon_Type=3 
| rex field=_raw "New Logon:[\s\S]*?Account Name:\s+(?<Targeted_Account>[^\r\n]+)" 
| stats count as Attempts by Source_Network_Address, Targeted_Account  
| sort - Attempts  
| head 10  
```

This query searches for logs in the "windows_logs" index with an EventCode of 4624 (successful login) and a Logon_Type of 3 (network logon), extracts the targeted account name using a regular expression, and then uses the stats command to count the number of attempts by source network address and targeted account. It then sorts the results in descending order by attempts and returns the top 10 results.

### Full Insight Table

To create a table that provides full insight into failed logins, you can use the following query:

```
index="windows_logs" EventCode=4625 Logon_Type=3  | rex field=_raw "Account For Which Logon Failed:[\s\S]*?Account Name:\s+(?<Targeted_Account>[^\r\n]+)" 
| table _time, Source_Network_Address, Targeted_Account, Failure_Reason, ComputerName  
| eval Status="Failed"  
| sort - _time

					OR

index="windows_logs" EventCode IN (4624, 4625) Logon_Type=3  | rex field=_raw "Account For Which Logon Failed:[\s\S]*?Account Name:\s+(?<Account_Name>[^\r\n]+)" 
| stats count by Source_Network_Address, Account_Name, ComputerName, Keywords  
| sort - _time
```

This query searches for logs in the "windows_logs" index with an EventCode of 4625 (failed login) and a Logon_Type of 3 (network logon), extracts the targeted account name using a regular expression, and then uses the table command to display the time, source network address, targeted account, failure reason, and computer name. It also uses the eval command to create a new field called Status that is set to "Failed". Finally, it sorts the results in descending order by time.

Once we have formulated queries like the ones above, we can proceed with creating a dashboard in Splunk.

## Step To Create a Dashboard

### Step 1: Create a New Dashboard
  
- Log in to your Splunk instance and navigate to the **Search & Reporting** page.  
- Go to **Dashboard** tab.
- Click on the **Create Dashboard** button.  
- Enter a title and description for your dashboard. 
- Select the Dashboard Type: **Classic** or **Studio**
- Choose a layout for your dashboard: **Absolute** or **Grid**  
- Click **Create** to create the dashboard.  

![](2025-03-26-9.1.5---RDP-Dashboard-2.png)
![](2025-03-26-9.1.5---RDP-Dashboard-3.png)

### Step 2: Insert Charts and Tables into a Dashboard
  
- Go to **Search and Reporting** and enter a search query.    
- Run the search and view the results.  
- Click on **Save As** and select **Existing Dashboard**.  
- Choose the dashboard you want to add the panel to from the list.  
- Give the panel a title and click **Save to Dashboard**.  

![](2025-03-26-9.1.5---RDP-Dashboard-4.png)

![](2025-03-26-9.1.5---RDP-Dashboard-5.png)

### Step 3: Add Multiple Panels to the Dashboard
  
- Repeat the process in Step 2 for each new search query you want to add. This will allow you to create multiple panels, each displaying a different search query.  
  
### Step 4: Arrange Panels on the Dashboard

- Go to **Dashboard** tab.
- Click on **Edit** to edit the dashboard.  
- Use the drag-and-drop feature to arrange the panels in the desired order.  
- Use the resize feature to adjust the size of each panel as needed.  
- Click **Save** to save the changes to the dashboard.  

Before Arranging:

![](2025-03-26-9.1.5---RDP-Dashboard-6.png)

After Arranging: 

![](2025-03-26-9.1.5---RDP-Dashboard-7.png)

### Step 5: Sync Time Range Across All Panels

Lastly we need to Synchronize Time Range Across All Panels to the Dashboard. This would provide us with Consistency and Flexibility making sure that All panels use the same time range, ensuring data alignment and that Changing the global time range updates all panels automatically. 

- On your dashboard, click **Edit**.  
- For each panel, click the **pencil icon** (edit button) next to the search name under the **Data Source** section.  
- In the **Time Range** dropdown, select **Input**.  
- Under **Input**, choose **Global Time Range (global_time)**.  
- Click **Save** to save the changes to the panel.   
- Use the **Time Picker** in your dashboard to set the global time range to your desired window (e.g., 24-hour real-time window).

![](2025-03-26-9.1.5---RDP-Dashboard-8.png)

